{
  $schema: 'https://docs.renovatebot.com/renovate-schema.json',
  extends: [
    'config:best-practices',
    ':semanticCommitsDisabled',
  ],
  branchPrefix: 'grafanarenovatebot/',
  commitMessagePrefix: 'Chore: ',
  platformCommit: 'enabled',
  dependencyDashboard: false,
  forkProcessing: 'disabled',
  rebaseWhen: 'behind-base-branch',
  prHourlyLimit: 0,
  prConcurrentLimit: 10,
  branchConcurrentLimit: 10,
  enabledManagers: [
    'custom.regex',
    'gomod',
  ],
  labels: [
    'dependencies',
  ],
  gomod: {
    enabled: true,
  },
  postUpdateOptions: [
    'gomodTidyE',
  ],
  packageRules: [
    {
      matchManagers: [
        'gomod',
      ],
      matchUpdateTypes: [
        'digest',
      ],
      schedule: 'before 8am on monday every 2 weeks',
    },
    {
      matchManagers: [
        'gomod',
      ],
      matchPackageNames: 'github.com/prometheus/*',
      groupName: 'prometheus-go',
    },
  ],
  customManagers: [
    {
      customType: 'regex',
      datasourceTemplate: 'docker',
      versioningTemplate: 'semver',
      registryUrlTemplate: 'https://ghcr.io',
      fileMatch: [
        '(^|/)Makefile$',
        '.*\\.jsonnet$',
        '.*\\.mk$',
        '^\\.github/workflows/.*\\.ya?ml$',
      ],
      matchStrings: [
        '\\bghcr\\.io/(?<depName>grafana/grafana-build-tools):(?<currentValue>v\\d+\\.\\d+\\.\\d+)(?:@(?<currentDigest>sha256:[a-f0-9]+))?\\b',
      ],
    },
    {
      customType: 'regex',
      datasourceTemplate: 'github-releases',
      depNameTemplate: 'grafana/k6',
      fileMatch: [
        '.*\\.mk',
      ],
      matchStrings: [
        '(?:^|\\n)[ \\t]*K6_VERSION\\s*:=\\s*(?<currentValue>\\S+)[ \\t]*(?:$|\\n)',
      ],
    },
    {
      customType: 'regex',
      fileMatch: [
        'Dockerfile',
      ],
      matchStrings: [
        '\\bapk\\b.+?\\badd\\b.+?(--repository|-X)[ =\\t]+(?<alpineRepo>[a-z]+)\\s+(?<depName>[-\\w]+?)=(?<currentValue>[-.\\w]+)',
      ],
      versioningTemplate: 'loose',
      datasourceTemplate: 'custom.alpine-{{alpineRepo}}',
      extractVersionTemplate: '{{depName}}-(?<version>.+).apk',
    },
    {
      customType: 'regex',
      depNameTemplate: 'ghcr.io/renovatebot/renovate',
      datasourceTemplate: 'docker',
      fileMatch: [
        '^\\.github/workflows/.*\\.ya?ml$',
      ],
      matchStrings: [
        'renovate-version: (?<currentValue>[^@\\s]+)(?:@(?<currentDigest>\\S+))?',
        'RENOVATE_IMAGE=ghcr.io/renovatebot/renovate:(?<currentValue>[^@\\s]+)(?:@(?<currentDigest>\\S+))?',
      ],
    },
  ],
  customDatasources: {
    'alpine-main': {
      defaultRegistryUrlTemplate: 'https://dl-cdn.alpinelinux.org/alpine/latest-stable/main/x86_64/',
      format: 'html',
    },
    'alpine-community': {
      defaultRegistryUrlTemplate: 'https://dl-cdn.alpinelinux.org/alpine/latest-stable/community/x86_64/',
      format: 'html',
    },
  },
}
